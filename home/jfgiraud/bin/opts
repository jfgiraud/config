#!/bin/bash

tempf=$(mktemp)

command="$1"

$command --help | sed -e 's/^[[:space:]]\{16,\}.*//' -e 's/^[[:space:]]*//' | grep -E '^-' | sed -e 's/[[:space:]]\{2,\}.*//' -e 's/, /\n/' -e 's/\[\?=.*/:/' -e 's/ .*/:/' > $tempf

longopts=$(grep -- '--' $tempf | sed -e 's/--//' | tr '\n' ',' | sed -e 's/,$//')
shortopts=$(grep -v -- '--' $tempf)

cat $tempf
echo $longopts
echo $shortopts

rm -f $tempf

exit 1

usage() {
	cat <<-EOF
NAME

        ${0##*/} - change file timestamps

DESCRIPTION

       Update the access and modification times of each FILE to the current time.

       A FILE argument that does not exist is created empty. The parent directories containing the file are also created if needed.

AUTHOR

       Written by Jean-François Giraud.

COPYRIGHT

       Copyright © 2014 Jean-François Giraud.  License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.
       This is free software: you are free to change and redistribute it.  There is NO WARRANTY, to the extent permitted by law.

EOF
	exit 0
}


error() {
    STATUS="$1"
    MSG="$2"
    cat >&2 <<-EOF
${0##*/}: $MSG
Try \`${0##*/} -h\` for more information.
EOF
    exit 1
}

if [ $# -eq 0 ]; then
    error 1 "Missing parameters!" 
fi

if [[ $# -eq 1 && "$1" == "-h" ]]; then
    usage
fi

for file in $*; do
    dn=${file%/*}
    fn=${file##*/}
    mkdir -p $dn && touch $dn/$fn
done 
